/**
 * Lists image files in two subfolders under public/assets/tactical-signs and writes
 * src/data/tacticalSignsPaths.ts. Run from project root:
 *   node scripts/list-tactical-signs.cjs
 *
 * Folder structure:
 *   public/assets/tactical-signs/Sotilasmerkistö/   → Sotilasmerkistö button
 *   public/assets/tactical-signs/Joukkojen koko/   → Joukkojen koko button
 * Filename (without extension) = correct answer term. Re-run after adding/renaming images.
 */
const fs = require('fs')
const path = require('path')

const TACTICAL_BASE = path.join(__dirname, '..', 'public', 'assets', 'tactical-signs')
const OUT_FILE = path.join(__dirname, '..', 'src', 'data', 'tacticalSignsPaths.ts')
const EXTENSIONS = new Set(['.jpg', '.jpeg', '.png', '.webp'])
const IGNORED_DIRS = new Set(['vanhat'])

const FOLDER_SOTILASMERKISTO = 'Sotilasmerkistö'
const FOLDER_JOUKKOJEN_KOKO = 'Joukkojen koko'

function walkDir(dir, pathPrefix, acc) {
  if (!fs.existsSync(dir)) return
  const entries = fs.readdirSync(dir, { withFileTypes: true })
  for (const e of entries) {
    const full = path.join(dir, e.name)
    const rel = pathPrefix ? `${pathPrefix}/${e.name}` : e.name
    if (e.isDirectory()) {
      if (IGNORED_DIRS.has(e.name.toLowerCase())) continue
      walkDir(full, rel, acc)
    } else if (EXTENSIONS.has(path.extname(e.name).toLowerCase())) {
      acc.push('/assets/tactical-signs/' + rel.replace(/\\/g, '/'))
    }
  }
}

const sotilasmerkistoPaths = []
const joukkojenKokoPaths = []

const dirSotilasmerkisto = path.join(TACTICAL_BASE, FOLDER_SOTILASMERKISTO)
const dirJoukkojenKoko = path.join(TACTICAL_BASE, FOLDER_JOUKKOJEN_KOKO)

walkDir(dirSotilasmerkisto, FOLDER_SOTILASMERKISTO, sotilasmerkistoPaths)
walkDir(dirJoukkojenKoko, FOLDER_JOUKKOJEN_KOKO, joukkojenKokoPaths)

sotilasmerkistoPaths.sort()
joukkojenKokoPaths.sort()

const content = `/**
 * Taktiset merkit image paths by folder.
 * Generated by: node scripts/list-tactical-signs.cjs (run from project root)
 * Folders: public/assets/tactical-signs/Sotilasmerkistö/ and .../Joukkojen koko/
 * Filename (without extension) = correct answer. Re-run after adding/renaming images.
 */
export const TACTICAL_SIGNS_SOTILASMERKISTO_PATHS: string[] = ${JSON.stringify(sotilasmerkistoPaths, null, 2)}

export const TACTICAL_SIGNS_JOUKKOJEN_KOKO_PATHS: string[] = ${JSON.stringify(joukkojenKokoPaths, null, 2)}
`

fs.writeFileSync(OUT_FILE, content, 'utf8')
console.log('Wrote', sotilasmerkistoPaths.length, 'Sotilasmerkistö paths and', joukkojenKokoPaths.length, 'Joukkojen koko paths to', OUT_FILE)
